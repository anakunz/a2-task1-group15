---
title: "Salmon Group 15"
author: "Anastasia Kunz, Zoe Duerksen-Salm, Catherine Takata"
date: "1/30/2021"
output: 
  html_document:
    theme: flatly
    toc: true
    toc_float: true
    code_folding: hide 
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(here)
library(janitor)
library(feasts)
library(tsibble)
library(slider)
library(lubridate)
```

# Tab 2: Seasonplots

This “Seasonplots” tab should contain: 

- A finalized seasonplot for each species (coho, jack coho, steelhead). You can either facet, or use patchwork, to make the figure. Add a caption. 
- Add 2 - 3 bulletpoints summarizing the major trends you see in the seasonplots.
Remember: All code that you used to wrangle the data and prepare the graphs should be available to see if we click on the Code buttons. 
```{r seasonplot1}
coho_jack_steel <- read_csv(here("data","willamette_fish_passage.csv")) %>% 
  clean_names() %>% 
  select(date, coho, jack_coho, steelhead) 

# convert df to a tsibble
cjs_ts <- coho_jack_steel %>% 
  mutate(date = lubridate::mdy(date)) %>% 
  as_tsibble(key = NULL, index = date)
```

```{r seasonplot2}
cjs_ts_tidy <- cjs_ts %>% 
  pivot_longer(`coho`:`steelhead`, # The columns I'm gathering together
               names_to = "fish_species", # new column name for existing names
               values_to = "fish_count") # new column name to store values

cjs_ts_tidy %>% 
  filter(year(date) > 2000) %>% 
  gg_season(y = fish_count) +
  theme_minimal() +
  labs(x = "Time (month)",
       y = "Total monthly fish count (n)",
       title = "Seasonal Fish Counts")
```
