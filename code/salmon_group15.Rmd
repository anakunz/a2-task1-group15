---
title: "Salmon Group 15"
author: "Anastasia Kunz, Zoe Duerksen-Salm, Catherine Takata"
date: "1/30/2021"
output: 
  html_document:
    theme: flatly
    toc: true
    toc_float: true
    code_folding: hide 
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(here)
library(janitor)
library(feasts)
library(tsibble)
library(slider)
library(lubridate)
```

# Tab 2: Seasonplots

A finalized seasonplot for each species (coho, jack coho, steelhead), segmented with `facet_wrap`. 
```{r seasonplot1}
coho_jack_steel <- read_csv(here("data","willamette_fish_passage.csv")) %>% 
  clean_names() %>% 
  select(date, coho, jack_coho, steelhead) 

# convert df to a tsibble
cjs_ts <- coho_jack_steel %>% 
  mutate(date = lubridate::mdy(date)) %>% 
  as_tsibble(key = NULL, index = date)
```

```{r seasonplot2}
cjs_ts_tidy <- cjs_ts %>% 
  pivot_longer(`coho`:`steelhead`, # The columns I'm gathering together
               names_to = "fish_species", # new column name for existing names
               values_to = "fish_count") %>% # new column name to store values
  index_by(yr_mo = ~yearmonth(.)) %>% 
  group_by(fish_species) %>% 
  summarize(monthly_fish_count = sum(fish_count, na.rm = TRUE))

cjs_ts_tidy %>% 
  filter(year(yr_mo) > 2000) %>% 
  gg_season(y = monthly_fish_count) +
  theme_minimal() +
  labs(x = "Time (month)",
       y = "Total monthly fish count (n)",
       title = "Seasonal Fish Counts")
```

### Summary

Mapping the seasonality of total adult salmon from 2001-2010  highlights regular fluctuations in passage:

- Jack Coho and Coho species pass through the Columbia Basin in the late summer and fall (August-November), with highest passage numbers occurring seasonally in the month of September.

- Steelhead species pass through the Columbia Basin in higher densities and throughout the year. However, Steelhead do pass more frequently in the spring and early summer (February-June), with highest passage numbers observed in May and June.

